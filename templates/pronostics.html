<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Pronostics MPP</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .tabs { list-style: none; padding: 0; display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .tabs li { display: inline; }
        .tabs a { text-decoration: none; padding: 8px 12px; background: #ddd; border-radius: 5px; color: #000; }
        .tabs a.active { background: #007bff; color: #fff; }
        .tab-content { display: none; border: 1px solid #ddd; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
        .match { margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .match input { width: 60px; }
    </style>
</head>
<body class="container py-3">

<h1>Pronostics MPP</h1>

<!-- Onglets Journ√©es -->
<ul class="tabs">
  {% for j in data %}
    <li><a href="#j{{ j.journee_id }}" class="{% if loop.first %}active{% endif %}">{{ j.journee_nom }}</a></li>
  {% endfor %}
</ul>

<!-- Contenu Journ√©es -->
{% for j in data %}
<div id="j{{ j.journee_id }}" class="tab-content" style="{% if loop.first %}display:block{% endif %}">
    <h3>{{ j.journee_nom }}</h3>

    {% if j.verrouille %}
    <div class="alert alert-danger">Pronostics verrouill√©s üîí</div>
    {% endif %}

    <!-- X2 -->
    {% if not j.x2_active and not j.x2_used and not j.verrouille %}
    <form method="post" action="/x2/{{ j.journee_id }}">
        <button class="btn btn-danger w-100 mb-3">üî• Activer X2 sur cette journ√©e</button>
    </form>
    {% elif j.x2_active %}
    <div class="alert alert-warning mb-3">üî• X2 activ√© pour cette journ√©e !</div>
    {% endif %}

    <form method="post">
        {% for m in j.matchs %}
        <div class="match">
            <strong>{{ m.equipe_dom }} vs {{ m.equipe_ext }}</strong>
            <input type="number" name="score_dom_{{ m.id }}" min="0" placeholder="Domicile" {% if j.verrouille %}disabled{% endif %}>
            -
            <input type="number" name="score_ext_{{ m.id }}" min="0" placeholder="Ext√©rieur" {% if j.verrouille %}disabled{% endif %}>
        </div>
        {% endfor %}
        {% if not j.verrouille %}
        <button class="btn btn-primary mt-2">Valider mes pronostics</button>
        {% endif %}
    </form>

    {% if j.verrouille and j.pronos %}
    <h5 class="mt-4">Pronostics des joueurs</h5>
    {% for p in j.pronos %}
    <p>{{ p[0] }} {{ p[1] }} : {{ p[2] }} {{ p[4] }} - {{ p[5] }} {{ p[3] }}</p>
    {% endfor %}
    {% endif %}
</div>
{% endfor %}

<p class="mt-3"><a href="/">‚Üê Retour accueil</a></p>

<script>
const tabs = document.querySelectorAll('.tabs a');
const contents = document.querySelectorAll('.tab-content');

tabs.forEach(tab => {
    tab.addEventListener('click', e => {
        e.preventDefault();
        tabs.forEach(t => t.classList.remove('active'));
        contents.forEach(c => c.style.display = 'none');

        tab.classList.add('active');
        document.querySelector(tab.getAttribute('href')).style.display = 'block';
    });
});
</script>

</body>
</html>
